# Api_bank_balance

Приложение Api_bank_balance представляет собой ассинхронное REST Api для управления банковский балансом пользователя. В проекте реализовано создание пользователя, получение информации о пользователе, пополнение счета пользователя, списание средств со счета пользователя, перевод средств другому пользователю, а также получение информации о всех транзакциях пользователя. Документация проекта с примерами запросов доступна по ссылке `http://localhost:8000/docs` после запуска проекта.

## Стек:
- **Python** — 3.11.0
- **FastAPI** — 0.115.8
- **Alembic** — 1.14.1
- **PostgreSQL** — 16
- **SQLAlchemy** — 2.0.38
- **Docker** - 24.0.6

## Запуск приложения через docker compose:

- Склонируйте репозиторий и перейдите в директорию проекта

```shell
git clone https://github.com/Milkyaway13/api_bank_balance
```
- Создайте файл `.env` и настройте его согласно примеру `.env.example`

- Запустите контейнер приложения

  
##### Для Linux & MacOS

```shell
sudo docker compose up -d
```
##### Для Windows

```
docker compose up -d
```

## Вопрос про несколько веб-сервисов с 1 базой

Первое, что пришло в голову - это использовать очередь задач, Celery или Redis queue, я немного работал с Celery, поэтому можно с помощью Celery настроить очередность выполнения задач. Но там тоже возможен конфликт, если несколько воркеров запущено, поэтому стоит на уровне БД настроить атомарность, чтобы у нас несколько операций выполнялись либо все вместе в рамках одной транзакции, и тогда мы коммитим изменение, либо мы делаем откат транзакции, если хотя бы одна из операций внутри транзакции не выполнилась. Ещё есть блокировки, но как точно они реализованы я не знаю, могу предположить, что если нам прилетит к бд две операции, которые могут конфликтовать, то при выполнении первой операции нам надо как-то заблокировать баланс, пока эта операция не выполнится.



